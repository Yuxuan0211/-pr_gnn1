import torch
import torch.nn.functional as F
import numpy as np

# 常量配置（源自《分区物理0.17.pdf》2.5.1节、表1；《分区物理0.18.pdf》2.5节）
CONFIG = {
    "gamma": 1.4,          # 比热比（量热完全气体假设，两文件2.5.1节）
    "cp": 1005.0,          # 定压比热（空气默认值，两文件2.5.1节）
    "C1": 1.2,             # 激波区阈值（P/ρ > C1×来流值，表1）
    "C2": 0.01,            # 边界层区阈值（μt > C2 Pa·s，表1）
    "C3": 0.3,             # 边界层区阈值（速度 < C3×来流速度，表1）
    "C4": 0.005,           # 尾流区阈值（μt > C4 Pa·s，表1）
    "C5": 0.5,             # 尾流区阈值（Vx < C5×来流Vx，表1）
    "C6": 0.001,           # 无粘/来流区阈值（μt < C6 Pa·s，表1）
    "C7": 0.05,            # 来流区阈值（物理量与来流偏差 < 5%，表1）
    "lambda_phys": 0.5,    # 物理约束总权重（两文件2.5节）
    "w_thermo": 1.0,       # 热力学损失权重（2.5.1节）
    "w_vorticity": 1.0,    # 涡量损失权重（2.5.3节）
    "w_noslip": 2.0,       # 无滑移损失权重（2.5.4节）
    "w_wake": 1.5,         # 尾流损失权重（2.5.4节）
    "w_energy": 1.0,       # 能量守恒损失权重（2.5.2节）
    "w_inviscid": 1.0,     # 无粘区损失权重（2.5.4节）
    "w_freestream": 2.0    # 来流区损失权重（2.5.4节）
}